(this.webpackJsonptomatode=this.webpackJsonptomatode||[]).push([[0],{164:function(e,t,a){e.exports=a.p+"static/media/pomotodo-spinner.d60d20e8.gif"},171:function(e,t,a){e.exports=a(318)},180:function(e,t,a){},202:function(e,t,a){},265:function(e,t,a){},266:function(e,t,a){},267:function(e,t,a){},270:function(e,t,a){},271:function(e,t,a){},274:function(e,t,a){},275:function(e,t,a){},288:function(e,t,a){},290:function(e,t,a){},291:function(e,t,a){},294:function(e,t,a){},295:function(e,t,a){},318:function(e,t,a){"use strict";a.r(t);var n=a(0),o=a.n(n),r=a(3),c=a.n(r),i=a(16),l=a(58),s=a(48),u=function(e,t){switch(e=e||[],t.type){case"ADD_TODO":return[t.payload].concat(Object(s.a)(e));case"INIT_TODOS":return Object(s.a)(t.payload);case"UPDATE_TODO":return e.map((function(e){return e.id===t.payload.id?t.payload:e}));case"EDIT_TODO":return e.map((function(e){return e.id===t.payload?Object.assign({},e,{editing:!0}):Object.assign({},e,{editing:!1})}));default:return e}},m=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"START_TOMATO":return[t.payload].concat(Object(s.a)(e));case"INIT_TOMATOES":return t.payload;case"UPDATE_TOMATO":return e.map((function(e){return e.id===t.payload.id?t.payload:e}));case"EDIT_TOMATO":return console.log("edit"),e.map((function(e){return e.id===t.payload?Object.assign({},e,{editing:!0}):Object.assign({},e,{editing:!1})}));default:return e}},d=Object(l.b)({todos:u,tomatoes:m}),p=Object(l.c)(d),f=(a(180),a(51),a(15)),E=a(6),v=a.n(E),h=(a(91),a(63)),T=a(9),b=a(326),g=a(42),O=a(45),y=a(140),k=a.n(y),j=a(19),w=k.a.create({baseURL:"https://gp-server.hunger-valley.com/",headers:{"t-app-id":"syzDKSikpvth7UQxVZjHadf2","t-app-secret":"fozkv4EKRftwyuSCTiiFdnLc"}});w.interceptors.request.use((function(e){var t=localStorage.getItem("x-token");return t&&(e.headers.Authorization="Bearer ".concat(t)),e}),(function(e){return console.error(e),Promise.reject(e)})),w.interceptors.response.use((function(e){return e.headers["x-token"]&&localStorage.setItem("x-token",e.headers["x-token"]),e}),(function(e){return 401===e.response.status&&Object(j.b)().push("/login"),Promise.reject(e)}));var N,D=w,x=(a(202),function(){var e=Object(n.useState)(""),t=Object(T.a)(e,2),a=t[0],r=t[1],c=Object(n.useState)(""),i=Object(T.a)(c,2),l=i[0],s=i[1],u=Object(g.f)();return o.a.createElement("div",{className:"login"},o.a.createElement("h1",null,"\u6b22\u8fce\u767b\u9646 Tomatodo"),o.a.createElement(f.a,{size:"large",placeholder:"\u8bf7\u8f93\u5165\u7528\u6237\u540d",prefix:o.a.createElement(b.a,null),onChange:function(e){r(e.target.value)}}),o.a.createElement(f.a.Password,{size:"large",placeholder:"\u8bf7\u8f93\u5165\u5bc6\u7801",onChange:function(e){s(e.target.value)}}),o.a.createElement("button",{onClick:function(){return v.a.async((function(e){for(;;)switch(e.prev=e.next){case 0:D.post("sign_in/user",{account:a,password:l}).then((function(){u.push("/")}),(function(e){422===e.response.status&&h.a.error("\u7528\u6237\u540d\u6216\u5bc6\u7801\u9519\u8bef\uff0c\u8bf7\u91cd\u65b0\u8f93\u5165")}));case 1:case"end":return e.stop()}}))},className:"login-button"},"\u767b\u9646"),"\u5982\u679c\u6ca1\u6709\u8d26\u53f7\uff0c\u8bf7\u7acb\u523b",o.a.createElement(O.b,{to:"/signUp",className:"link"},"\u6ce8\u518c"))}),C=(a(265),function(){var e=Object(n.useState)(""),t=Object(T.a)(e,2),a=t[0],r=t[1],c=Object(n.useState)(""),i=Object(T.a)(c,2),l=i[0],s=i[1],u=Object(n.useState)(""),m=Object(T.a)(u,2),d=m[0],p=m[1],E=Object(g.f)();return o.a.createElement("div",{className:"sign-up"},o.a.createElement("h1",null,"\u6b22\u8fce\u6ce8\u518c Tomatodo"),o.a.createElement(f.a,{size:"large",placeholder:"\u8bf7\u8f93\u5165\u7528\u6237\u540d",prefix:o.a.createElement(b.a,null),onChange:function(e){r(e.target.value)}}),o.a.createElement(f.a.Password,{size:"large",placeholder:"\u8bf7\u8f93\u5165\u5bc6\u7801",onChange:function(e){s(e.target.value)}}),o.a.createElement(f.a.Password,{size:"large",placeholder:"\u8bf7\u518d\u6b21\u8f93\u5165\u5bc6\u7801",onChange:function(e){p(e.target.value)}}),o.a.createElement("button",{onClick:function(){return v.a.async((function(e){for(;;)switch(e.prev=e.next){case 0:D.post("sign_up/user",{account:a,password:l,password_confirmation:d}).then((function(){console.log("\u6ce8\u518c\u6210\u529f"),E.push("/login")}),(function(e){throw new Error(e)}));case 1:case"end":return e.stop()}}))},className:"login-button"},"\u6ce8\u518c"),"\u5982\u679c\u5df2\u7ecf\u6709\u8d26\u53f7\uff0c\u8bf7\u7acb\u523b",o.a.createElement(O.b,{to:"/login",className:"link"},"\u767b\u9646"))}),_=a(27),S=a(322),M=a(323),I=a(329),A=(a(266),a(74),a(14)),G=function(e){return{type:"INIT_TODOS",payload:e}},P=function(e){return{type:"UPDATE_TODO",payload:e}},H=a(330),z=(a(267),a(268),a(168)),U=a(1),B=a.n(U),F=(a(270),a(327)),W=a(328),K={updateTodo:P,editTodo:function(e){return{type:"EDIT_TODO",payload:e}}},L=Object(i.b)((function(e,t){var a=e.todos;return Object(_.a)({todos:a},t)}),K)((function(e){var t=Object(n.useState)(e.todo.description),a=Object(T.a)(t,2),r=a[0],c=a[1],i=function(){l(""!==r?{description:r}:{deleted:!0})},l=function(t){var a,n;return v.a.async((function(o){for(;;)switch(o.prev=o.next){case 0:return a=e.todo.id,o.prev=1,o.next=4,v.a.awrap(D.put("todos/".concat(a),t));case 4:n=o.sent,e.updateTodo(n.data.resource),o.next=11;break;case 8:throw o.prev=8,o.t0=o.catch(1),new Error(o.t0);case 11:case"end":return o.stop()}}),null,null,[[1,8]])},s=o.a.createElement("span",{onDoubleClick:function(){return t=e.todo.id,void e.editTodo(t);var t}},e.todo.description),u=o.a.createElement("div",{className:"editing"},o.a.createElement(f.a,{placeholder:"\u6309\u56de\u8f66\u952e\u786e\u8ba4\u5220\u9664\u8fd9\u4e2a\u4efb\u52a1",value:r,onChange:function(e){return c(e.target.value)},onPressEnter:i,autoFocus:!0}),o.a.createElement("div",{className:"iconWrapper"},o.a.createElement(F.a,{onClick:i}),o.a.createElement(W.a,{onClick:function(){return l({deleted:!0})}}))),m=B()({"input-todos":!0,editing:e.todo.editing,completed:e.todo.completed});return o.a.createElement("div",{className:m},o.a.createElement(z.a,{checked:e.todo.completed,onChange:function(e){l({completed:e.target.checked,completed_at:new Date})}}),e.todo.editing?u:s)})),R={addTodo:function(e){return{type:"ADD_TODO",payload:e}}},q=Object(i.b)((function(e){return Object(_.a)({},e)}),R)((function(e){var t=Object(n.useState)(""),a=Object(T.a)(t,2),r=a[0],c=a[1],i=function(){var t;return v.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:if(""===r){a.next=14;break}return a.prev=1,a.next=4,v.a.awrap(D.post("todos",{description:r}));case 4:t=a.sent,e.addTodo(t.data.resource),c(""),a.next=12;break;case 9:throw a.prev=9,a.t0=a.catch(1),new Error(a.t0);case 12:a.next=15;break;case 14:h.a.error("\u8bf7\u6307\u5b9a\u4e00\u4e2a\u4efb\u52a1");case 15:case"end":return a.stop()}}),null,null,[[1,9]])};return o.a.createElement("div",{className:"todo-input"},o.a.createElement(f.a,{size:"large",placeholder:"\u6dfb\u52a0\u65b0\u4efb\u52a1",suffix:r?o.a.createElement(F.a,{onClick:i}):o.a.createElement("span",null),onChange:function(e){return c(e.target.value)},onPressEnter:i,value:r}))})),J={initTodos:G},Q=Object(i.b)((function(e,t){return Object(_.a)({},t)}),J)((function(e){var t=Object(n.useState)(!1),a=Object(T.a)(t,2),r=a[0],c=a[1];return o.a.createElement("div",{className:"todos"},o.a.createElement(q,null),e.unCompleted.length>0?o.a.createElement("main",{className:"todoList"},e.unCompleted.map((function(e){return o.a.createElement(L,{key:e.id,todo:e})})),o.a.createElement(A.a,{onClick:function(){return c(!r)},className:"show-history"},"\u6700\u8fd1\u5b8c\u6210\u4efb\u52a1",r?o.a.createElement(I.a,null):o.a.createElement(H.a,null)),r?e.completed.map((function(e){return o.a.createElement(L,{key:e.id,todo:e})})):""):o.a.createElement("main",{className:"no-record-container"},o.a.createElement("div",{className:"no-record"},o.a.createElement("svg",{className:"icon","aria-hidden":"true"},o.a.createElement("use",{xlinkHref:"#icon-todo"})),o.a.createElement("div",null,"\u6ca1\u6709\u8bb0\u5f55")),o.a.createElement("div",{className:"todoList"},o.a.createElement(A.a,{onClick:function(){return c(!r)},className:"show-history"},"\u6700\u8fd1\u5b8c\u6210\u4efb\u52a1",r?o.a.createElement(I.a,null):o.a.createElement(H.a,null)),r?e.completed.map((function(e){return o.a.createElement(L,{key:e.id,todo:e})})):"")))})),V=function(e){return{type:"UPDATE_TOMATO",payload:e}},Z=(a(271),a(272),a(167)),$=a(151),X=a(152),Y=a(169),ee=a(153),te=a(170),ae=(a(274),function(e){function t(e){var a;return Object($.a)(this,t),(a=Object(Y.a)(this,Object(ee.a)(t).call(this,e))).startCountDown=function(){N=setInterval((function(){var e=a.state.remaining;a.setState({remaining:e-1e3}),a.props.rest?document.title="".concat(a.clock," - \u4f11\u606f\u65f6\u95f4"):document.title="".concat(a.clock," - \u6709\u4e00\u4e2a\u756a\u8304\u6b63\u5728\u8fdb\u884c"),e<1e3&&(a.onTimeOver(),document.title="Tomatodo")}),1e3)},a.onTimeOver=function(){a.props.onfinish(),document.title="Tomatodo - \u4f60\u7684\u756a\u8304\u571f\u8c46",clearInterval(N)},a.state={remaining:a.props.timer},a}return Object(te.a)(t,e),Object(X.a)(t,[{key:"componentDidMount",value:function(){this.startCountDown()}},{key:"componentWillUnmount",value:function(){this.onTimeOver()}},{key:"render",value:function(){var e=1-this.state.remaining/this.props.duration;return o.a.createElement("div",{className:"countdown"},o.a.createElement("span",null,this.clock),o.a.createElement("div",{className:"progress",style:{width:"".concat(100*e,"%")}}))}},{key:"clock",get:function(){var e=Math.floor(this.state.remaining/1e3/60),t=Math.floor(this.state.remaining/1e3%60);return"".concat(e.toString().padStart(2,"0"),":").concat(t.toString().padStart(2,"0"))}}]),t}(o.a.Component)),ne=a(331),oe=(a(275),function(e){var t=Object(n.useState)(""),a=Object(T.a)(t,2),r=a[0],c=a[1],i=Object(n.useState)(!1),l=Object(T.a)(i,2),s=l[0],u=l[1],m=function(){var t=e.unfinishedTomato.id;e.updateTomato(t,{description:r,ended_at:new Date}),u(!0),setTimeout((function(){c("")}),500)},d=function(){u(!1),c(" "),c("")},p=Z.a.confirm,E=function(){p({title:s?"\u8981\u53d6\u6d88\u4f11\u606f\u65f6\u95f4\u5417\uff1f":"\u60a8\u76ee\u524d\u6b63\u5728\u4e00\u4e2a\u756a\u8304\u5de5\u4f5c\u65f6\u95f4\u4e2d\uff0c\u8981\u653e\u5f03\u8fd9\u4e2a\u756a\u8304\u5417\uff1f",width:500,mask:!0,keyboard:!0,onOk:function(){s?u(!1):function(){var t=e.unfinishedTomato.id;e.updateTomato(t,{aborted:!0})}()},onCancel:function(){}})};return o.a.createElement("div",{className:"tomato-action"},function(){if(!e.unfinishedTomato&&!s)return o.a.createElement(A.a,{onClick:e.startTomato,className:"startTomato"},"\u5f00\u59cb\u4e00\u4e2a\u756a\u8304");var t,a=0,n=e.unfinishedTomato,i=Date.parse((new Date).toString());return s?t=3e5:(a=Date.parse(n.started_at.toString()),t=n.duration),i-a<=t||s?o.a.createElement("div",{className:"timer-wrapper"},o.a.createElement(ae,{timer:s?t:t-i+a,onfinish:d,duration:t,rest:s}),o.a.createElement(ne.a,{className:"abort",onClick:E})):i-a>t?o.a.createElement("div",{className:"input-wrapper"},o.a.createElement(f.a,{value:r,placeholder:"\u4f60\u521a\u521a\u5b8c\u6210\u4e86\u4ec0\u4e48\u5de5\u4f5c\uff1f",onChange:function(e){return c(e.target.value)},onPressEnter:m}),o.a.createElement(ne.a,{className:"abort",onClick:E})):void 0}())}),re=a(321),ce=(a(288),function(e){var t="".concat(Object(re.a)(new Date(e.tomato.started_at),"HH:mm")," - \n  ").concat(Object(re.a)(new Date(e.tomato.ended_at),"HH:mm"));return o.a.createElement("div",{className:"item"},o.a.createElement("span",{className:"duration"},t),o.a.createElement("span",{className:"description"},e.tomato.description))}),ie=function(e){var t=Object.keys(e.finishedTomatoGroup).sort((function(e,t){return Date.parse(t)-Date.parse(e)})).splice(0,3).map((function(t){var a=e.finishedTomatoGroup[t];return o.a.createElement("div",{key:t,className:"tomato"},o.a.createElement("div",{className:"title"},o.a.createElement("span",{className:"date"},Object(re.a)(new Date(t),"M\u6708d\u65e5")),o.a.createElement("span",{className:"finished"},"\u5b8c\u6210\u4e86",a.length,"\u4e2a\u756a\u8304")),a.map((function(e){return o.a.createElement(ce,{key:e.id,tomato:e})})))}));return o.a.createElement("div",{className:"tomato-list"},t)},le={startTomato:function(e){return{type:"START_TOMATO",payload:e}},updateTomato:V},se=Object(i.b)((function(e,t){return Object(_.a)({},t)}),le)((function(e){return o.a.createElement("div",{className:"tomatoes"},o.a.createElement(oe,{startTomato:function(){var t;return v.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,v.a.awrap(D.post("tomatoes",{duration:15e5}));case 3:t=a.sent,e.startTomato(t.data.resource),a.next=10;break;case 7:throw a.prev=7,a.t0=a.catch(0),new Error(a.t0);case 10:case"end":return a.stop()}}),null,null,[[0,7]])},unfinishedTomato:e.unfinishedTomatoes[0],updateTomato:function(t,a){var n;return v.a.async((function(o){for(;;)switch(o.prev=o.next){case 0:return o.prev=0,o.next=3,v.a.awrap(D.put("tomatoes/".concat(t),a));case 3:n=o.sent,e.updateTomato(n.data.resource),o.next=10;break;case 7:throw o.prev=7,o.t0=o.catch(0),new Error(o.t0);case 10:case"end":return o.stop()}}),null,null,[[0,7]])}}),Object.keys(e.finishedTomatoGroup).length>0?o.a.createElement(ie,{finishedTomatoGroup:e.finishedTomatoGroup}):o.a.createElement("div",{className:"no-record"},o.a.createElement("svg",{className:"icon","aria-hidden":"true"},o.a.createElement("use",{xlinkHref:"#icon-alarm-clock"})),o.a.createElement("div",null,"\u6ca1\u6709\u8bb0\u5f55")))})),ue=a(61),me=a.n(ue),de=(a(290),a(291),function(e){return o.a.createElement("div",{className:"polygon"},o.a.createElement("svg",null,o.a.createElement("polygon",{fill:"rgba(215,78,78,0.1)",stroke:"rgba(215,78,78,0.5)",strokeWidth:"1",points:function(){var t=Object.keys(e.dailyTodo).sort((function(e,t){return Date.parse(e)-Date.parse(t)})),a=Date.parse(t[0])-864e5;if(a){var n=(new Date).getTime()-a,o=t.map((function(t){var o=(Date.parse(t)-a)/n*240;0===n&&(o=240);var r=60*(1-e.dailyTodo[t].length/e.totalCompleted);return"".concat(o,",").concat(r)}));return["0,60"].concat(Object(s.a)(o),["240,0","240,60"]).join(" ")}return"0,60 240,60"}()})))}),pe=(a(292),a(88)),fe=a(325),Ee=a(320),ve=(a(294),a(295),{updateTodo:P,updateTomato:V,editTomato:function(e){return{type:"EDIT_TOMATO",payload:e}}}),he=Object(i.b)((function(e,t){return Object(_.a)({},t)}),ve)((function(e){var t=Object(n.useState)(e.data.description),a=Object(T.a)(t,2),r=a[0],c=a[1],i=function(){s(""!==r?{description:r}:{aborted:!0})},l=function(t){var a,n;return v.a.async((function(o){for(;;)switch(o.prev=o.next){case 0:return a=e.data.id,o.prev=1,o.next=4,v.a.awrap(D.put("todos/".concat(a),t));case 4:n=o.sent,e.updateTodo(n.data.resource),o.next=11;break;case 8:throw o.prev=8,o.t0=o.catch(1),new Error(o.t0);case 11:case"end":return o.stop()}}),null,null,[[1,8]])},s=function(t){var a,n;return v.a.async((function(o){for(;;)switch(o.prev=o.next){case 0:return console.log(1),a=e.data.id,o.prev=2,o.next=5,v.a.awrap(D.put("tomatoes/".concat(a),t));case 5:n=o.sent,e.updateTomato(n.data.resource),o.next=12;break;case 9:throw o.prev=9,o.t0=o.catch(2),new Error(o.t0);case 12:case"end":return o.stop()}}),null,null,[[2,9]])};return o.a.createElement("div",{className:"item"},o.a.createElement("div",{className:"detail"},"completed"===e.itemType?o.a.createElement("span",{className:"time"},Object(re.a)(new Date(e.data.updated_at),"HH:mm")):"deleted"===e.itemType?o.a.createElement("span",{className:"time"},Object(re.a)(new Date(e.data.updated_at),"M\u6708d\u65e5")):"finishedToamto"===e.itemType?o.a.createElement("span",{className:"time"},Object(re.a)(new Date(e.data.started_at),"HH:mm"),"-",Object(re.a)(new Date(e.data.ended_at),"HH:mm")):"abortTomato"===e.itemType?o.a.createElement("span",{className:"time"},Object(re.a)(new Date(e.data.started_at),"M\u6708d\u65e5")):void 0,"finishedToamto"!==e.itemType&&"abortTomato"!==e.itemType||!e.data.editing?o.a.createElement("span",null,e.data.description||"\u8fd9\u662f\u4e00\u4e2a\u6ca1\u6709\u63cf\u8ff0\u7684\u756a\u8304"):o.a.createElement(f.a,{placeholder:"\u6309\u56de\u8f66\u952e\u786e\u8ba4\u5220\u9664\u8fd9\u4e2a\u4efb\u52a1",value:r,onChange:function(e){return c(e.target.value)},onPressEnter:i,autoFocus:!0})),"completed"===e.itemType?o.a.createElement("div",{className:"action"},o.a.createElement("span",{onClick:function(){return l({completed:!1})}},"\u6062\u590d "),o.a.createElement("span",{onClick:function(){return l({deleted:!0})}},"\u5220\u9664")):"deleted"===e.itemType?o.a.createElement("div",{className:"action"},o.a.createElement("span",{onClick:function(){return l({deleted:!1})}},"\u6062\u590d")):"finishedToamto"===e.itemType?e.data.editing?o.a.createElement("div",{className:"action editing"},o.a.createElement("span",{onClick:i},"\u63d0\u4ea4 "),o.a.createElement("span",{onClick:function(){return s({editing:!1})}},"\u53d6\u6d88")):o.a.createElement("div",{className:"action"},o.a.createElement("span",{onClick:function(){return e.editTomato(e.data.id)}},"\u7f16\u8f91 "),o.a.createElement("span",{onClick:function(){return s({aborted:!0})}},"\u5220\u9664")):"abortTomato"===e.itemType?e.data.editing?o.a.createElement("div",{className:"action editing"},o.a.createElement("span",{onClick:i},"\u63d0\u4ea4 "),o.a.createElement("span",{onClick:function(){return s({editing:!1})}},"\u53d6\u6d88")):o.a.createElement("div",{className:"action"},o.a.createElement("span",{onClick:function(){return e.editTomato(e.data.id)}},"\u7f16\u8f91 ")):void 0)})),Te=pe.a.TabPane,be=function(e){var t=function(){return me.a.groupBy(e.completed,(function(e){return Object(re.a)(new Date(e.updated_at),"yyyy-MM-d")}))},a=function(e){return Object.keys(e).sort((function(e,t){return Date.parse(t)-Date.parse(e)}))},n=a(t()).map((function(e){var a=t()[e];return o.a.createElement("div",{key:e,className:"list"},o.a.createElement("div",{className:"title"},o.a.createElement("div",{className:"date-container"},o.a.createElement("span",{className:"date"},Object(re.a)(new Date(e),"M\u6708d\u65e5")),o.a.createElement("span",null,Object(re.a)(new Date(e),"E"))),o.a.createElement("span",null,"\u5b8c\u6210\u4e86 ",a.length," \u4e2a\u4efb\u52a1")),o.a.createElement("div",{className:"items"},a.map((function(e){return o.a.createElement(he,{data:e,key:e.id,itemType:"completed"})}))))})),r=e.deleted.map((function(e){return o.a.createElement(he,{data:e,key:e.id,itemType:"deleted"})})),c=a(e.finishedTomatoGroup).map((function(t){var a=e.finishedTomatoGroup[t],n=0;a.forEach((function(e){n+=Object(fe.a)(Object(Ee.a)(e.ended_at.toString()),Object(Ee.a)(e.started_at.toString()))}));var r=Math.floor(n/60)<1?"":" ".concat(Math.floor(n/60)," \u5c0f\u65f6");return o.a.createElement("div",{key:t,className:"list"},o.a.createElement("div",{className:"title"},o.a.createElement("div",{className:"date-container"},o.a.createElement("span",{className:"date"},Object(re.a)(new Date(t),"M\u6708d\u65e5")),o.a.createElement("span",null,Object(re.a)(new Date(t),"E"))),o.a.createElement("div",null,"\u5b8c\u6210\u4e86 ",a.length," \u4e2a\u756a\u8304"),o.a.createElement("span",null,"\u603b\u8ba1",r," ".concat(n%60," \u5206\u949f"))),o.a.createElement("div",{className:"items"},a.map((function(e){return o.a.createElement(he,{data:e,key:e.id,itemType:"finishedToamto"})}))))})),i=e.abortTomatoes.map((function(e){return o.a.createElement(he,{data:e,key:e.id,itemType:"abortTomato"})}));return o.a.createElement(o.a.Fragment,null,"todo"===e.historyType?o.a.createElement("div",{className:"history"},o.a.createElement(pe.a,{defaultActiveKey:"1"},o.a.createElement(Te,{tab:"\u5df2\u5b8c\u6210\u4efb\u52a1",key:"1"},n),o.a.createElement(Te,{tab:"\u5df2\u5220\u9664\u4efb\u52a1",key:"2"},r))):"tomato"===e.historyType?o.a.createElement("div",{className:"history"},o.a.createElement(pe.a,{defaultActiveKey:"1"},o.a.createElement(Te,{tab:"\u5b8c\u6210\u7684\u756a\u8304",key:"1"},c),o.a.createElement(Te,{tab:"\u88ab\u6253\u65ad\u7684\u756a\u8304",key:"2"},i))):void 0)},ge=function(e){var t=Object(n.useState)(""),a=Object(T.a)(t,2),r=a[0],c=a[1];return o.a.createElement("div",{className:"statistics"},o.a.createElement("ul",null,o.a.createElement("li",{onClick:function(){return c("tomato")},className:"tomato"===r?"active":""},o.a.createElement("div",{className:"text"},o.a.createElement("span",{className:"title"},"\u756a\u8304\u5386\u53f2"),o.a.createElement("span",null,"\u7d2f\u8ba1\u5b8c\u6210\u756a\u8304"),o.a.createElement("span",{className:"count"},e.finishedTomatoes.length)),o.a.createElement(de,{dailyTodo:e.finishedTomatoGroup,totalCompleted:e.finishedTomatoes.length})),o.a.createElement("li",{onClick:function(){return c("todo")},className:"todo"===r?"active":""},o.a.createElement("div",{className:"text"},o.a.createElement("span",{className:"title"},"\u4efb\u52a1\u5386\u53f2"),o.a.createElement("span",null,"\u7d2f\u8ba1\u5b8c\u6210\u4efb\u52a1"),o.a.createElement("span",{className:"count"},e.completed.length)),o.a.createElement(de,{dailyTodo:me.a.groupBy(e.completed,(function(e){return Object(re.a)(new Date(e.updated_at),"yyyy-MM-d")})),totalCompleted:e.completed.length}))),r?o.a.createElement(be,{finishedTomatoGroup:e.finishedTomatoGroup,abortTomatoes:e.abortTomatoes,completed:e.completed,deleted:e.deleted,historyType:r}):o.a.createElement("span",null))},Oe=a(164),ye=a.n(Oe),ke={initTodos:G,initTomatoes:function(e){return{type:"INIT_TOMATOES",payload:e}}},je=Object(i.b)((function(e,t){var a=e.todos,n=a.filter((function(e){return e.deleted})),o=a.filter((function(e){return!e.deleted})),r=o.filter((function(e){return e.completed}))||[],c=o.filter((function(e){return!e.completed}))||[],i=e.tomatoes,l=e.tomatoes.filter((function(e){return e.aborted&&!e.ended_at})),s=e.tomatoes.filter((function(e){return!e.description&&!e.ended_at&&!e.aborted})),u=e.tomatoes.filter((function(e){return e.description&&e.ended_at&&!e.aborted})),m=me.a.groupBy(u,(function(e){return Object(re.a)(new Date(e.started_at),"yyyy-MM-d")}));return Object(_.a)({todos:a,deleted:n,completed:r,unCompleted:c,tomatoes:i,unfinishedTomatoes:s,finishedTomatoGroup:m,finishedTomatoes:u,abortTomatoes:l},t)}),ke)((function(e){var t=Object(g.f)(),a=Object(n.useState)({}),r=Object(T.a)(a,2),c=r[0],i=r[1],l=Object(n.useState)(!0),s=Object(T.a)(l,2),u=s[0],m=s[1],d=function(){var e;return v.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,v.a.awrap(D.get("/me"));case 2:e=t.sent,i(e.data);case 4:case"end":return t.stop()}}))},p=function(){var t,a;return v.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,v.a.awrap(D.get("todos"));case 3:t=n.sent,a=t.data.resources.map((function(e){return Object.assign({},e,{editing:!1})})),e.initTodos(a),n.next=11;break;case 8:throw n.prev=8,n.t0=n.catch(0),new Error(n.t0);case 11:case"end":return n.stop()}}),null,null,[[0,8]])},f=function(){var t,a;return v.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,v.a.awrap(D.get("tomatoes"));case 3:t=n.sent,a=t.data.resources.map((function(e){return Object.assign({},e,{editing:!1})})),e.initTomatoes(a),n.next=11;break;case 8:throw n.prev=8,n.t0=n.catch(0),new Error(n.t0);case 11:case"end":return n.stop()}}),null,null,[[0,8]])};Object(n.useEffect)((function(){Promise.all([d(),p(),f()]).then((function(){m(!1)}),(function(e){console.log(e)}))}),[]);var E=o.a.createElement(S.a,null,o.a.createElement(S.a.Item,{key:"1"},o.a.createElement("span",null,"\u504f\u597d\u8bbe\u7f6e")),o.a.createElement(S.a.Item,{key:"2",onClick:function(){localStorage.setItem("x-token",""),t.push("/login")}},o.a.createElement("span",null,"\u767b\u51fa"))),h=o.a.createElement("img",{src:ye.a,alt:"loading",className:"loading"});return o.a.createElement("div",{className:"index"},u?h:o.a.createElement(o.a.Fragment,null,o.a.createElement("header",null,o.a.createElement("h1",null,o.a.createElement("svg",{className:"icon","aria-hidden":"true"},o.a.createElement("use",{xlinkHref:"#icon-fanqie"})),"Tomatodo"),o.a.createElement(M.a,{overlay:E,trigger:["click"]},o.a.createElement("a",{href:" ",className:"ant-dropdown-link",onClick:function(e){return e.preventDefault()}},o.a.createElement("span",null,c.account),o.a.createElement(I.a,null)))),o.a.createElement("main",null,o.a.createElement("div",{className:"container"},o.a.createElement(se,{finishedTomatoGroup:e.finishedTomatoGroup,unfinishedTomatoes:e.unfinishedTomatoes})),o.a.createElement("div",{className:"container"},o.a.createElement(Q,{completed:e.completed,unCompleted:e.unCompleted}))),o.a.createElement(ge,{completed:e.completed,deleted:e.deleted,finishedTomatoGroup:e.finishedTomatoGroup,finishedTomatoes:e.finishedTomatoes,abortTomatoes:e.abortTomatoes})))})),we=function(){return o.a.createElement(O.a,null,o.a.createElement(g.c,null,o.a.createElement(g.a,{path:"/login"},o.a.createElement(x,null)),o.a.createElement(g.a,{path:"/signUp"},o.a.createElement(C,null)),o.a.createElement(g.a,{exact:!0,path:"/"},o.a.createElement(je,null))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(o.a.createElement(i.a,{store:p},o.a.createElement(we,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[171,1,2]]]);
//# sourceMappingURL=main.927e749c.chunk.js.map